<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Login - Anime Watched</title>

    <link rel="icon" type="image/png" href="./assets/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="./assets/favicon/favicon.svg" />
    <link rel="shortcut icon" href="./assets/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/favicon/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Anime Watched" />
    <link rel="manifest" href="./assets/favicon/site.webmanifest" />

    <link href="./css/bootstrap.min.css" rel="stylesheet" />
    <link href="./css/style.css" rel="stylesheet" />

    <style>
      :root {
        --bg1: #0f172a; /* dark navy */
        --bg2: #0b1020; /* deeper */
        --accent: #7c3aed; /* purple */
        --glass: rgba(255, 255, 255, 0.06);
        --muted: rgba(255, 255, 255, 0.7);
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: Inter, system-ui, Segoe UI, Roboto, "Helvetica Neue", Arial;
        background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
        color: #fff;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }

      .container {
        width: 100%;
        max-width: 980px;
        display: grid;
        grid-template-columns: 1fr 420px;
        gap: 32px;
        align-items: center;
      }

      .brand {
        padding: 32px;
        border-radius: 16px;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        box-shadow: 0 6px 30px rgba(2, 6, 23, 0.6);
        min-height: 420px;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 14px;
        margin-bottom: 18px;
      }
      .logo .icon {
        width: 68px;
        height: 68px;
        border-radius: 12px;
        background: linear-gradient(135deg, #ff6b6b, #7c3aed);
        display: grid;
        place-items: center;
        font-weight: 700;
        font-size: 22px;
        color: white;
        box-shadow: 0 6px 18px rgba(124, 58, 237, 0.28);
      }
      h1 {
        margin: 0 0 8px 0;
        font-size: 26px;
      }
      p.lead {
        margin: 0;
        color: var(--muted);
        line-height: 1.5;
      }

      .card {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        border-radius: 14px;
        padding: 28px;
        backdrop-filter: blur(6px);
        box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6);
      }

      form {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      label {
        font-size: 13px;
        color: var(--muted);
      }
      input[type="text"],
      input[type="password"],
      input[type="email"] {
        width: 100%;
        padding: 12px 14px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        background: rgba(255, 255, 255, 0.02);
        color: white;
        font-size: 15px;
        outline: none;
        transition: box-shadow 0.15s, border-color 0.15s;
      }
      input:focus {
        box-shadow: 0 6px 20px rgba(124, 58, 237, 0.12);
        border-color: rgba(124, 58, 237, 0.9);
      }

      .row {
        display: flex;
        gap: 12px;
      }
      .remember {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--muted);
        font-size: 14px;
      }

      .btn {
        padding: 12px 14px;
        border-radius: 10px;
        border: 0;
        background: linear-gradient(90deg, var(--accent), #ff6b6b);
        color: white;
        font-weight: 600;
        cursor: pointer;
        font-size: 15px;
      }
      .btn.ghost {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }
      .actions {
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: space-between;
        margin-top: 8px;
      }

      .alt {
        font-size: 13px;
        color: var(--muted);
        text-align: center;
        margin-top: 12px;
      }
      a.link {
        color: #dbeafe;
        text-decoration: none;
      }

      .hint {
        font-size: 13px;
        color: #fca5a5;
      }

      /* small screens */
      @media (max-width: 880px) {
        .container {
          grid-template-columns: 1fr;
          max-width: 520px;
        }
        .brand {
          order: 2;
        }
      }

      footer {
        margin-top: 18px;
        color: var(--muted);
        font-size: 13px;
        text-align: center;
      }

      .eye-btn {
        background: transparent;
        border: 0;
        color: var(--muted);
        cursor: pointer;
        padding: 6px;
        border-radius: 8px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <aside class="brand card" aria-hidden="false">
        <div class="logo">
          <div class="icon">AW</div>
          <div>
            <h1 class="text-white">AnimeWatched</h1>
            <p class="lead">
              Tieni traccia delle tue serie anime preferite. Accedi per vedere
              la tua lista, voti e cronologia.
            </p>
          </div>
        </div>

        <div style="margin-top: 18px; color: var(--muted)">
          <strong>Caratteristiche</strong>
          <ul style="margin-top: 8px; line-height: 1.6; color: var(--muted)">
            <li>Lista personale degli episodi visti</li>
            <li>Valutazioni e commenti</li>
            <li>Consigli basati sui tuoi gusti</li>
          </ul>
        </div>

        <footer>Se non hai un account, registrati gratuitamente.</footer>
      </aside>

      <main class="card" aria-labelledby="loginTitle">
        <h2 id="loginTitle" class="text-white">Accedi al tuo account</h2>
        <p class="alt">
          Usa il tuo account per sincronizzare la lista su tutti i dispositivi.
        </p>

        <form id="loginForm" novalidate>
          <div>
            <label for="email">Email</label>
            <input
              id="email"
              name="email"
              type="email"
              placeholder="tuo@esempio.com"
              required
              autocomplete="username"
            />
          </div>

          <div>
            <label for="password">Password</label>
            <div style="display: flex; gap: 8px; align-items: center">
              <input
                id="password"
                name="password"
                type="password"
                placeholder="Inserisci la password"
                required
                autocomplete="current-password"
              />
              <button
                type="button"
                class="eye-btn"
                id="togglePwd"
                aria-label="Mostra password"
              >
                üëÅÔ∏è
              </button>
            </div>
          </div>

          <div
            class="row"
            style="align-items: center; justify-content: space-between"
          >
            <label class="remember"
              ><input id="remember" type="checkbox" /> Ricordami</label
            >
            <a class="link" href="#" id="forgot">Password dimenticata?</a>
          </div>

          <div class="actions">
            <button class="btn" type="submit">Accedi</button>
            <button class="btn ghost" type="button" id="demo">
              Prova demo
            </button>
          </div>

          <div class="alt" style="margin-top: 18px">
            Non hai un account?
            <a class="link" href="#" id="signup">Registrati</a>
          </div>

          <p
            id="feedback"
            class="hint"
            role="status"
            aria-live="polite"
            style="display: none"
          ></p>
        </form>
      </main>
    </div>

    <script>
      // NOTE: Questo file √® una pagina di login client-side. Per la produzione:
      // - Implementa l'autenticazione sul server (es. JWT/OAuth) o usa un provider (Firebase Auth, Auth0, Supabase, ecc.)
      // - Non memorizzare password in localStorage.
      // - Usa HTTPS per tutte le richieste.

      const form = document.getElementById("loginForm");
      const feedback = document.getElementById("feedback");
      const togglePwd = document.getElementById("togglePwd");
      const pwdInput = document.getElementById("password");
      const demoBtn = document.getElementById("demo");

      togglePwd.addEventListener("click", () => {
        const t =
          pwdInput.getAttribute("type") === "password" ? "text" : "password";
        pwdInput.setAttribute("type", t);
        togglePwd.textContent = t === "text" ? "üôà" : "üëÅÔ∏è";
      });

      demoBtn.addEventListener("click", () => {
        // Demo rapido: crea una sessione finta
        localStorage.setItem(
          "aw_user",
          JSON.stringify({
            email: "demo@animewatched.local",
            name: "Demo User",
          })
        );
        feedback.style.display = "block";
        feedback.textContent =
          "Accesso demo effettuato. Verrai reindirizzato...";
        setTimeout(() => {
          window.location.href = "/";
        }, 900);
      });

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        feedback.style.display = "none";

        const email = form.email.value.trim();
        const password = form.password.value;

        if (!email) {
          showError("Inserisci un indirizzo email valido");
          return;
        }
        if (password.length < 6) {
          showError("Password troppo corta (min 6 caratteri)");
          return;
        }

        // MOCK authentication: sostituisci con fetch verso API reale
        // esempio: fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,password})})

        // per adesso: se la mail contiene "@" e password valida -> successo
        if (email.includes("@")) {
          const user = { email, emailLocalPart: email.split("@")[0] };
          if (document.getElementById("remember").checked) {
            localStorage.setItem("aw_user", JSON.stringify(user));
          } else {
            sessionStorage.setItem("aw_user", JSON.stringify(user));
          }
          feedback.style.display = "block";
          feedback.style.color = "#bbf7d0";
          feedback.textContent = "Accesso riuscito! Reindirizzamento...";
          // redirect
          setTimeout(() => {
            window.location.href = "/";
          }, 700);
        } else {
          showError("Credenziali non valide");
        }
      });

      function showError(msg) {
        feedback.style.display = "block";
        feedback.style.color = "#fca5a5";
        feedback.textContent = msg;
      }

      // Se l'utente √® gi√† loggato (local/session storage) -> redirect
      (function checkSession() {
        const user =
          localStorage.getItem("aw_user") || sessionStorage.getItem("aw_user");
        if (user) {
          // piccolo delay per mostrare che √® gi√† loggato
          setTimeout(() => {
            // window.location.href = "/";
          }, 250);
        }
      })();
    </script>
  </body>
</html>
